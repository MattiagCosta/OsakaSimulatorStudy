<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=edge'>
	<title>Sata Andagi</title>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<link rel='stylesheet' type='text/css' media='screen' href='style.css'>
	<script src='script.js'></script>
</head>
<body>
	<h1>tsu_han.dat hacking ü§Ø</h1>

	<p>Welcome to the Sata Andagi tsu_han.dat hacking page! Here you can load and manipulate the tsu_han.dat file. (This was generated by AI btw üòñ)</p>

	<p>Create a custom save file for Osaka Simulator.</p>

	<p>WARNING‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è<br>I worked only on the Standalone version of Osaka Simulator. I don't believe the tsu_han.dat file is different in the other versions, but be careful. Always create a copy of your current game before you replace it.</p>

	<p>Find more <a href="https://github.com/MattiagCosta/OsakaSimulatorStudy">here</a>.</p>

	<hr>

	<h3>Load fresh start tsu_han.dat file</h3>
	<p>If you click the orange/yellow button in the pause menu, you restart the game with a fresh start.</p>
	<button onclick="LoadFreshStart()">Load fresh start</button>

	<hr>

	<h3>Load a tsu_han.dat file</h3>
	<input type="file" id="file-input" accept=".dat">
	<button onclick="LoadTsu_han_datFile()">Load the file choosen</button>

	<hr>

	<h3>Customize your file</h3>

	<label for="yen">Number of yen</label>

	<div>
		<input type="checkbox" id="limits" checked="true">
		<label for="limits">Activate / deactivate limits for the number of yen</label>
	</div>

	<input type="number" id="yen" min="0">

	<script>
		document.getElementById('yen').addEventListener('input', function(e){
			if(!document.getElementById('limits').checked){ return; }
			if(isNaN(this.value) || this.value<0){
				this.value = 0;
			}
			if(this.value>YEN_LIMIT){
				this.value = YEN_LIMIT;
			}
		});

		function InvertSelection(){
			let checkboxes = document.querySelectorAll('#items-list input[type="checkbox"]');
			for(let checkbox of checkboxes){
				checkbox.checked = !checkbox.checked;
			}
		}

		function SelectAll(){
			let checkboxes = document.querySelectorAll('#items-list input[type="checkbox"]');
			for(let checkbox of checkboxes){
				checkbox.checked = true;
			}
		}

		function DeselectAll(){
			let checkboxes = document.querySelectorAll('#items-list input[type="checkbox"]');
			for(let checkbox of checkboxes){
				checkbox.checked = false;
			}
		}
	</script>

	<h4>List of items</h4>

	<div>
		<button onclick="InvertSelection()">Invert selection</button>
		<button onclick="SelectAll()">Select all</button>
		<button onclick="DeselectAll()">Deselect all</button>
	</div>

	<ul id="items-list"></ul>

	<script>
		for(let item of ITEMS_LIST){
			let li = document.createElement('li');
			let checkbox = document.createElement('input');
			checkbox.type = 'checkbox'
			checkbox.id = item;
			let label = document.createElement('label');
			label.htmlFor = item;
			label.textContent = item;

			for(let tag in TAGS){
				if(TAGS[tag].includes(item)){
					label.textContent += " *" + tag;
				}
			}

			if(TRANSLATIONS[item]){
				label.textContent += " [-" + TRANSLATIONS[item] + "-]";
			}

			li.appendChild(checkbox);
			li.appendChild(label);
			document.getElementById('items-list').appendChild(li);
		};
	</script>

	<p>Click the button to download a new save file based on the options you have chosen. The file will be named "tsu_han.dat". Remember that Osaka Simulator can't leave files named other than that, so if you download "tsu_han (1).dat" or something similar, rename it.</p>
	<button onclick="DownLoadTsu_han_datFile()">Download file (yay!)</button>

	<hr>

	<button onclick="CreateItemsListSubset()">Create subset</button>
	<p id="subset-output">Subset output (probably not very useful for you)</p>

	<hr>

	<h3>tsu_han.dat visualized (hexadecimal)</h3>

	<p class="color-paragraph key"><span>Various data (what I like to call "beginning mess")</span><span>Data regarding the items</span></p>
	<p class="color-paragraph"><span>00000100c3bcb74403f8134126a57c42ace0b24250c30000550000000b</span><span>616b617a756b696e4361700000000008616c69616e4361700000000009616e74656e61436170000000000a616f72696e676f43617000000000096173756b614d696d690000000009626f6479426c6164650000000007626f6479566163000000000c626f64795669627261746f72000000000563686169720100000008636869796f4361700000000009636869796f4d696d690000000006636875636875000000000c636c6f7468417a6d616e67610000000009636c6f7468426c75650000000010636c6f746843686565724c6561646572000000000c636c6f746844656661756c74010000000a636c6f7468486174616e0000000009636c6f746850696e6b010000000a636c6f746850696e6b32000000000e636c6f7468547261696e696e6741000000000e636c6f7468547261696e696e6742000000000d636c6f746859616d61797572690000000005636f6e67610000000008646961626f6c6f73000000000e646f6d6f686f726e57696e6b6c650000000004646f6f720100000006656e64696e67000000000565746f6e61000000000e65746f6e6142726163656c65744c000000000e65746f6e6142726163656c657452000000000b65746f6e614b7562697761000000000a65746f6e614f73616765000000000965746f6e6157696e670000000007666c7970616e420000000005667572696e0000000008677265656e436170000000000768616962616e65000000000b68616962616e6552696e67000000000968656c6d6574436170000000000b68656e7368696e42656c740000000007686f7563686f750000000008696365437265616d00000000046a617a69000000000a6a617a6959656c6c6f77000000000a6b697461726f7543617000000000096b6f736d6f7343617000000000076b6f746174737500000000086b756d614d696d69000000000f6b75726f62756368694d6567616e6500000000076c656f74617264000000000a6c69676874536162657200000000076d61696443617000000000046d696c6b00000000046d6f6d6f00000000086d6f6d6f4d696d69000000000b6d7567697761726143617000000000096d756c74694d696d6900000000086e656b6f4d696d69000000000a6e656b6f53686970706f00000000096e656e656b6f43617001000000086e7572736543617000000000086f7361676543617000000000056f74616d61000000000c70616a616d614f72616e6765000000000a706170614d616b757261000000000b70756e6368696e6742616700000000077265694d696d6900000000087265697a6f756b6f000000000f726962626f6e446546726f6e4361700000000008736172754d696d69000000000a7361727553686970706f0000000006736567776179000000000773656e70756b69000000000a7368616d706f6f436170000000000a737461724d6567616e65000000000973756d6d657243617000000000047377696d000000000e7377696d4e6f53686f6c64657231000000000e7377696d4e6f53686f6c64657232000000000c7377696d53686f6c64657231000000000c7377696d53686f6c64657232000000000a74656c65706f727465720000000002747601000000077573614d696d690000000008776974636843617000000000</span></p>

	<h4>Beginning mess</h4>
	<p class="color-paragraph key"><span>Probably a flag of some sort</span><span>Unknown mess</span><span>Number of yen (it looks like 100.000.000 yen is the limit)</span><span>Something oddly specific</span><span>Separator (I call them "junk characters" because they are useless in terms of saving data)</span></p>
	<p class="color-paragraph"><span>00000100</span><span>c3bcb74403f8134126a57c42ace0b242</span><span>50c30000</span><span>55000000</span><span>0b</span></p>

	<h4>Unknown mess theory</h4>
	<p class="color-paragraph key"><span>A color</span><span>Some sort of separator (from what I've seen, it's always 44 or 45)</span><span>A float value</span><span>Another sort of separator (it's always 40, 41 or 42)</span><span>An integer</span></p>
	<p class="color-paragraph"><span>c3bcb7</span><span>44</span><span>03f8134126a57c</span><span>42</span><span>ace0b242</span></p>
	<p>See more about the beginning mess <a href="https://github.com/MattiagCosta/OsakaSimulatorStudy/blob/main/Research-Standalone/tsu_han_dat/tsu_han_dat-other/beginning_messes.txt">here</a>.</p>


	<h4>Item's data pattern</h4>
	<p class="color-paragraph key"><span>Item's name (it can include numbers)</span><span>The flag for the item, either 00000000 or 01000000</span><span>Junk separator (each item has its own)</span></p>
	<p class="color-paragraph"><span>616b617a756b696e436170</span><span>00000000</span><span>08</span></p>

	<script>
		[...document.getElementsByClassName("key")].forEach(element => {
			element.innerHTML = "<b>Key:</b>" + element.innerHTML;
		});
	</script>

	<hr>

	<h3>Change tsu_han.dat bytes</h3>
	
	<p>In the text area there is an example of a tsu_han.dat file in hexadecimal format. Change it as you want, but be careful when you load it into your game</p>
	<textarea>00000100c3bcb74403f8134126a57c42ace0b24250c30000550000000b616b617a756b696e4361700000000008616c69616e4361700000000009616e74656e61436170000000000a616f72696e676f43617000000000096173756b614d696d690000000009626f6479426c6164650000000007626f6479566163000000000c626f64795669627261746f72000000000563686169720100000008636869796f4361700000000009636869796f4d696d690000000006636875636875000000000c636c6f7468417a6d616e67610000000009636c6f7468426c75650000000010636c6f746843686565724c6561646572000000000c636c6f746844656661756c74010000000a636c6f7468486174616e0000000009636c6f746850696e6b010000000a636c6f746850696e6b32000000000e636c6f7468547261696e696e6741000000000e636c6f7468547261696e696e6742000000000d636c6f746859616d61797572690000000005636f6e67610000000008646961626f6c6f73000000000e646f6d6f686f726e57696e6b6c650000000004646f6f720100000006656e64696e67000000000565746f6e61000000000e65746f6e6142726163656c65744c000000000e65746f6e6142726163656c657452000000000b65746f6e614b7562697761000000000a65746f6e614f73616765000000000965746f6e6157696e670000000007666c7970616e420000000005667572696e0000000008677265656e436170000000000768616962616e65000000000b68616962616e6552696e67000000000968656c6d6574436170000000000b68656e7368696e42656c740000000007686f7563686f750000000008696365437265616d00000000046a617a69000000000a6a617a6959656c6c6f77000000000a6b697461726f7543617000000000096b6f736d6f7343617000000000076b6f746174737500000000086b756d614d696d69000000000f6b75726f62756368694d6567616e6500000000076c656f74617264000000000a6c69676874536162657200000000076d61696443617000000000046d696c6b00000000046d6f6d6f00000000086d6f6d6f4d696d69000000000b6d7567697761726143617000000000096d756c74694d696d6900000000086e656b6f4d696d69000000000a6e656b6f53686970706f00000000096e656e656b6f43617001000000086e7572736543617000000000086f7361676543617000000000056f74616d61000000000c70616a616d614f72616e6765000000000a706170614d616b757261000000000b70756e6368696e6742616700000000077265694d696d6900000000087265697a6f756b6f000000000f726962626f6e446546726f6e4361700000000008736172754d696d69000000000a7361727553686970706f0000000006736567776179000000000773656e70756b69000000000a7368616d706f6f436170000000000a737461724d6567616e65000000000973756d6d657243617000000000047377696d000000000e7377696d4e6f53686f6c64657231000000000e7377696d4e6f53686f6c64657232000000000c7377696d53686f6c64657231000000000c7377696d53686f6c64657232000000000a74656c65706f727465720000000002747601000000077573614d696d690000000008776974636843617000000000</textarea>
	<script>
		const textarea = document.querySelector('textarea');
		textarea.style.height = 'auto';
		textarea.style.height = textarea.scrollHeight + 'px';
	</script>
	<button onclick="DownloadTextareaAsTsu_han_datFile()">Download as tsu_han.dat file</button>

	<footer></footer>

</body>
</html>